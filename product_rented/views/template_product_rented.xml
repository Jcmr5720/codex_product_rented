<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="template_product_rented" name="Rented Products Page">
        <t t-call="website.layout">
            <section class="o-rented-products-hero py-5 py-lg-5">
                <div class="container hero-content">
                    <div class="row justify-content-center text-center mb-5">
                        <div class="col-lg-8">
                            <span class="badge rounded-pill bg-white text-primary fw-semibold px-3 py-2 shadow-sm mb-3">
                                Renta sin complicaciones
                            </span>
                            <h1 class="display-5 fw-bold text-dark mb-3">Explora nuestros productos para renta</h1>
                            <p class="lead text-muted mb-0">
                                Encuentra la solución perfecta para tus proyectos temporales con productos cuidadosamente seleccionados, listos para acompañarte cuando más los necesites.
                            </p>
                        </div>
                    </div>
                    <t t-if="products">
                        <div class="row g-4 g-xl-5">
                            <t t-foreach="products" t-as="product">
                                <t t-set="product_meta" t-value="product_ui_meta.get(product.id, {})"/>
                                <div class="col-12 col-sm-6 col-lg-4">
                                    <div class="o-rented-card h-100 d-flex flex-column">
                                        <div class="o-rented-card__image">
                                            <t t-set="product_image" t-value="website.image_url(product, 'image_1024')"/>
                                            <img
                                                t-att-src="product_image or '/web/static/src/img/placeholder.png'"
                                                t-att-alt="product.name"
                                                class="o-rented-card__image-media"
                                                loading="lazy"
                                                decoding="async"
                                            />
                                            <span class="o-rented-card__image-gradient" aria-hidden="true"/>
                                            <t t-set="badge_featured" t-value="product_meta.get('badge_featured')"/>
                                            <t t-set="badge_new" t-value="product_meta.get('badge_new')"/>
                                            <t t-set="badge_promo" t-value="product_meta.get('badge_promo')"/>
                                            <t t-if="badge_featured or badge_new or badge_promo">
                                                <div class="o-rented-card__badges">
                                                    <t t-if="badge_featured">
                                                        <span class="o-rented-card__badge o-rented-card__badge--featured">
                                                            Producto destacado
                                                        </span>
                                                    </t>
                                                    <t t-if="badge_new">
                                                        <span class="o-rented-card__badge o-rented-card__badge--new">
                                                            Nuevo
                                                        </span>
                                                    </t>
                                                    <t t-if="badge_promo">
                                                        <span class="o-rented-card__badge o-rented-card__badge--promo">
                                                            En promoción
                                                        </span>
                                                    </t>
                                                </div>
                                            </t>
                                        </div>
                                        <div class="o-rented-card__body d-flex flex-column">
                                            <h5 class="o-rented-card__title mb-2" t-esc="product.name"/>
                                            <p class="o-rented-card__description mb-3" t-esc="product.rented_description or product.website_description"/>
                                            <div class="mb-3">
                                                <t t-set="formatted_price" t-value="formatted_rented_prices.get(product.id)"/>
                                                <t t-if="formatted_price">
                                                    <div class="o-rented-card__price">Desde <span t-esc="formatted_price"/></div>
                                                </t>
                                                <t t-else="">
                                                    <div class="text-muted small mb-2">Precio de renta disponible al cotizar</div>
                                                    <t t-set="quote_url" t-value="product_meta.get('quote_url')"/>
                                                    <a t-att-href="quote_url" class="btn btn-outline-primary btn-sm w-100 o-rented-card__quote" role="button">
                                                        Solicitar cotización
                                                    </a>
                                                </t>
                                            </div>
                                            <t t-if="product.rented_time_option_ids">
                                                <div class="o-rented-card__chips mb-3">
                                                    <t t-foreach="product.rented_time_option_ids" t-as="time_option">
                                                        <t t-set="option_code" t-value="(time_option.code or '').lower()"/>
                                                        <t t-set="chip_variant" t-value="'day' if option_code.startswith('d') else 'week' if option_code.startswith('w') else 'month' if 'm' in option_code else 'year' if 'y' in option_code else 'custom'"/>
                                                        <t t-set="chip_icon" t-value="{'day': 'fa-sun-o', 'week': 'fa-calendar', 'month': 'fa-calendar-o', 'year': 'fa-hourglass-half'}.get(chip_variant, 'fa-clock-o')"/>
                                                        <span t-attf-class="o-rented-card__chip o-rented-card__chip--#{chip_variant}">
                                                            <i t-attf-class="fa #{chip_icon} me-1" role="presentation"/>
                                                            <t t-esc="time_option.display_name"/>
                                                        </span>
                                                    </t>
                                                </div>
                                            </t>
                                            <t t-set="product_time_prices" t-value="time_price_details.get(product.id)"/>
                                            <t t-if="product_time_prices">
                                                <div class="mb-3">
                                                    <h6 class="text-uppercase text-muted fs-6 mb-2">Tarifas de renta</h6>
                                                    <ul class="list-unstyled o-rented-card__rates mb-0">
                                                        <t t-foreach="product_time_prices" t-as="time_price_info">
                                                            <t t-set="rate_code" t-value="(time_price_info.get('option_code') or '').lower()"/>
                                                            <t t-set="rate_variant" t-value="'day' if rate_code.startswith('d') else 'week' if rate_code.startswith('w') else 'month' if 'm' in rate_code else 'year' if 'y' in rate_code else 'custom'"/>
                                                            <t t-set="rate_icon" t-value="{'day': 'fa-sun-o', 'week': 'fa-calendar', 'month': 'fa-calendar-o', 'year': 'fa-hourglass-half'}.get(rate_variant, 'fa-clock-o')"/>
                                                            <li class="d-flex align-items-start">
                                                                <span t-attf-class="badge rounded-pill fw-semibold me-2 border o-rented-card__rate-badge o-rented-card__rate-badge--#{rate_variant}">
                                                                    <i t-attf-class="fa #{rate_icon} me-1" role="presentation"/>
                                                                    <t t-esc="time_price_info['option_name']"/>
                                                                </span>
                                                                <span class="text-muted">
                                                                    <t t-if="time_price_info['formatted_price']">
                                                                        <t t-esc="time_price_info['formatted_price']"/>
                                                                    </t>
                                                                    <t t-elif="time_price_info['has_price']">
                                                                        <t t-esc="time_price_info['raw_price']"/>
                                                                    </t>
                                                                    <t t-else="">Precio disponible al cotizar</t>
                                                                </span>
                                                            </li>
                                                        </t>
                                                    </ul>
                                                </div>
                                            </t>
                                            <div class="mt-auto pt-3">
                                                <a t-att-href="product.website_url or '#'" class="btn btn-primary o-rented-card__cta w-100" role="button">
                                                    Ver detalles del producto
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </t>
                        </div>
                    </t>
                    <t t-else="">
                        <div class="row justify-content-center">
                            <div class="col-lg-6">
                                <div class="card border-0 shadow-sm text-center p-5">
                                    <div class="mb-3">
                                        <i class="fa fa-cube fa-3x text-primary" role="presentation"/>
                                    </div>
                                    <h4 class="fw-bold mb-2">Aún no hay productos disponibles</h4>
                                    <p class="text-muted mb-0">
                                        Estamos trabajando para añadir nuevas opciones de renta. Vuelve pronto para descubrir las novedades que tenemos para ti.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </t>
                </div>
            </section>
        </t>
    </template>
</odoo>
